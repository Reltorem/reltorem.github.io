---
layout: post
title: "DHCP"
date: 2025-11-19 12:00:00 +1000
categories: networking
---
**DHCP (Dynamic Host Configuration Protocol)**


DHCP is a service originally released in 1997 that automatically configures network settings and assigns IP addresses to devices when they connect to a network.

It is a service that runs on a network server. It commonly runs on home routers as well.

Before DHCP, network settings had to be manually configured for each device which is time-consuming and tedious - especially when you're dealing with enterprise scale networks.

It configures settings such as:
- IP addresses
- Subnet mask
- Default gateway
- DNS servers
- NTP servers

IP addresses are leased in a 4 step process called **DORA**: *Discover, Offer, Request, Acknowledge*.

- **Discover**: When a device connects to a network, it has no IP address and doesn't know the addresses of any other devices on the network. So it sends a broadcast from 0.0.0.0 over udp/**68** to the whole local network at 255.255.255.255 udp/**67**, asking for an offer from a DHCP server.
- Broadcasts usually are restricted to the immediate local network and don't cross router boundaries. If a DHCP server is seperated from the connecting device by a router however, routers will forward DHCP requests to the DHCP server through DHCP relay so the server can be contacted even if it's on a different segment of the network.

- **Offer**: When the DHCP server hears that a request is being made for an IP, it broadcasts an offer to 255.255.255.255:udp/**68**, as the connecting device still has no set IP address yet.
- The offer contains an IP address, lease time, gateway & DNS data and the DHCP server's own IP.

- **Request**: The connecting device then sends another broadcast over 255.255.255.255:udp/**67** requesting to lock in the IP offer.
- If a device receives multiple offers from multiple DHCP servers, it typically just selects the first one it receives.

- **Acknowledgement**: The DHCP server finally broadcasts an acknowledgement confirming that the new device is now assigned an IP by it and will not lease that IP to any other devices for the duration of the lease.

**DHCP Scopes**

- The DHCP server assigns IPs from a pre-configured pool.

The *scope* is the range of available IP addresses in this pool.

The scope must fall within the subnet boundaries (the subnet network and broadcast addresses).

e.g. a subnet with a network address (starting address) of 192.168.1.0/24 could assign IPs from 192.168.1.1 to 192.168.1.255

**IP Reservations**


Address reservations and exclusions can be made within the pool.

You may want certain devices like a printer or server to always have the same static IP. You could configure that manually on each individual device, but a much easier way would be to configure the DHCP server itself to simply reserve a specific IP and only ever lease it to that specific device.

Scopes are typically contiguous blocks of addresses and reservations are at the ends of the pool, but there's no reason why you can't reserve an IP in the middle of the scope.

DHCP servers keep track of devices and their associated IP addresses through their **MAC address**.

The server keeps a **MAC Address Table (MAT)** that keeps track of matching everything together.




